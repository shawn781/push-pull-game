<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨æ‹‰å°å‹‡å£«</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        
        .header {
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .game-area {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .scene-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .text-area {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 15px;
        }
        
        .problem {
            font-size: 1.3rem;
            margin-bottom: 10px;
            line-height: 1.5;
            font-weight: bold;
        }
        
        .hint {
            font-size: 1rem;
            color: #ffeb3b;
            font-style: italic;
        }
        
        .scene {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 15px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .scene-object {
            position: absolute;
            transition: all 1s ease;
        }
        
        .animal {
            font-size: 5rem;
            z-index: 10;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .tree {
            font-size: 6rem;
            z-index: 5;
        }
        
        .rock {
            font-size: 5rem;
            z-index: 5;
        }
        
        .banana {
            font-size: 3rem;
            z-index: 15;
        }
        
        .branch {
            font-size: 4rem;
            z-index: 8;
        }
        
        .turtle {
            font-size: 4rem;
            z-index: 10;
        }
        
        .giraffe {
            font-size: 5rem;
            z-index: 10;
        }
        
        .fence {
            font-size: 4rem;
            z-index: 5;
        }
        
        .hole {
            width: 120px;
            height: 100px;
            background: #8B4513;
            border-radius: 50%;
            position: absolute;
            z-index: 1;
        }
        
        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background: #8FBC8F;
            z-index: 2;
        }
        
        .actions {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .btn {
            padding: 15px 30px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-push {
            background: linear-gradient(to right, #FF416C, #FF4B2B);
            color: white;
        }
        
        .btn-pull {
            background: linear-gradient(to right, #00b09b, #96c93d);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .feedback {
            margin: 15px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .correct {
            color: #4CAF50;
        }
        
        .incorrect {
            color: #F44336;
        }
        
        .medals {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .medal {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .medal.earned {
            background: radial-gradient(circle at 30% 30%, #FFD700, #FFA000);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            transform: scale(1.1);
        }
        
        .medal-icon {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .medal-text {
            font-size: 0.7rem;
            text-align: center;
        }
        
        .progress {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #00b09b, #96c93d);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .level {
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        .qr-code {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 15px;
            display: inline-block;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            text-align: center;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        @media (max-width: 500px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1.1rem;
            }
            
            .animal {
                font-size: 4rem;
            }
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s ease;
        }
        
        .success-animation {
            animation: success 1s ease;
        }
        
        @keyframes success {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æ¨æ‹‰å°å‹‡å£«</h1>
            <p class="subtitle">å¸®åŠ©å°åŠ¨ç‰©è§£å†³éš¾é¢˜ï¼Œèµ¢å–æ¨åŠ›/æ‹‰åŠ›å‹‹ç« ï¼</p>
        </div>
        
        <div class="game-area">
            <div class="level">å…³å¡: <span id="level">1</span>/5</div>
            <div class="progress">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="scene-container">
                <div class="text-area">
                    <div class="problem" id="problem">å°ç†Šè¢«å¡åœ¨æ ‘æ´é‡Œï¼Œéœ€è¦å¸®åŠ©å®ƒå‡ºæ¥</div>
                    <div class="hint" id="hint">æç¤ºï¼šæ ‘æ´å¤ªå°ï¼Œå°ç†Šæ— æ³•è‡ªå·±è½¬èº«</div>
                </div>
                
                <div class="scene" id="scene">
                    <!-- åŠ¨æ€åœºæ™¯å…ƒç´ å°†é€šè¿‡JavaScriptæ·»åŠ  -->
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-push" id="push-btn">æ¨</button>
                <button class="btn btn-pull" id="pull-btn">æ‹‰</button>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="medals">
                <div class="medal" id="medal-1">
                    <div class="medal-icon">ğŸ¥‰</div>
                    <div class="medal-text">æ¨åŠ›å‹‹ç« </div>
                </div>
                <div class="medal" id="medal-2">
                    <div class="medal-icon">ğŸ¥ˆ</div>
                    <div class="medal-text">æ‹‰åŠ›å‹‹ç« </div>
                </div>
                <div class="medal" id="medal-3">
                    <div class="medal-icon">ğŸ¥‡</div>
                    <div class="medal-text">æ¨æ‹‰å¤§å¸ˆ</div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3>æ¸¸æˆè¯´æ˜</h3>
            <ul>
                <li>è§‚å¯ŸåŠ¨æ€åœºæ™¯ï¼Œé€‰æ‹©æ­£ç¡®çš„"æ¨"æˆ–"æ‹‰"åŠ¨ä½œ</li>
                <li>ç­”å¯¹5é“é¢˜å³å¯è·å¾—æ‰€æœ‰å‹‹ç« </li>
                <li>æ¯ä¸ªåœºæ™¯éƒ½æœ‰æç¤ºï¼Œä»”ç»†è§‚å¯Ÿå“¦ï¼</li>
                <li>æ‰«æäºŒç»´ç åœ¨æ‰‹æœºä¸Šç©æ›´ä¾¿æ·ï¼</li>
            </ul>
        </div>
        
        <div class="qr-code">
            <div id="qrcode"></div>
            <p style="color: #333; margin-top: 10px;">æ‰«æäºŒç»´ç åœ¨æ‰‹æœºä¸Šç©</p>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = [
            {
                animal: "ğŸ»",
                objects: [
                    { type: "tree", emoji: "ğŸŒ³", class: "tree", position: { right: "20px", bottom: "20px" } },
                    { type: "hole", class: "hole", position: { right: "50px", bottom: "20px" } }
                ],
                problem: "å°ç†Šè¢«å¡åœ¨æ ‘æ´é‡Œï¼Œéœ€è¦å¸®åŠ©å®ƒå‡ºæ¥",
                hint: "æç¤ºï¼šæ ‘æ´å¤ªå°ï¼Œå°ç†Šæ— æ³•è‡ªå·±è½¬èº«",
                correctAction: "pull",
                explanation: "æ­£ç¡®ï¼å°ç†Šè¢«å¡åœ¨æ ‘æ´é‡Œï¼Œåº”è¯¥æŠŠå®ƒæ‹‰å‡ºæ¥ã€‚",
                animalInitialPosition: { right: "55px", bottom: "35px" },
                animalFinalPosition: { right: "120px", bottom: "35px" }
            },
            {
                animal: "ğŸ˜",
                objects: [
                    { type: "rock", emoji: "ğŸª¨", class: "rock", position: { left: "180px", bottom: "20px" } },
                    { type: "ground", class: "ground", position: { bottom: "0", left: "0" } }
                ],
                problem: "å°è±¡æƒ³ç§»åŠ¨æŒ¡è·¯çš„å·¨çŸ³",
                hint: "æç¤ºï¼šå°è±¡åŠ›æ°”å¾ˆå¤§ï¼Œä½†å·¨çŸ³å¾ˆé‡",
                correctAction: "push",
                explanation: "æ­£ç¡®ï¼å°è±¡åŠ›æ°”å¾ˆå¤§ï¼Œå¯ä»¥æ¨å¼€å·¨çŸ³ã€‚",
                animalInitialPosition: { left: "100px", bottom: "20px" },
                objectInitialPosition: { left: "180px", bottom: "20px" },
                objectFinalPosition: { left: "250px", bottom: "20px" }
            },
            {
                animal: "ğŸ’",
                objects: [
                    { type: "banana", emoji: "ğŸŒ", class: "banana", position: { top: "30px", right: "50px" } },
                    { type: "branch", emoji: "ğŸŒ¿", class: "branch", position: { top: "60px", right: "40px" } },
                    { type: "tree", emoji: "ğŸŒ³", class: "tree", position: { right: "20px", bottom: "20px" } }
                ],
                problem: "å°çŒ´å­æƒ³æ‹¿åˆ°é«˜å¤„çš„é¦™è•‰",
                hint: "æç¤ºï¼šæ ‘æå¾ˆæŸ”éŸ§ï¼Œä½†å°çŒ´å­å¾ˆè½»",
                correctAction: "pull",
                explanation: "æ­£ç¡®ï¼å°çŒ´å­å¯ä»¥é€šè¿‡æ‹‰æ ‘ææ¥æ‹¿åˆ°é¦™è•‰ã€‚",
                animalInitialPosition: { left: "100px", bottom: "20px" },
                objectInitialPosition: { top: "30px", right: "50px" },
                objectFinalPosition: { top: "120px", right: "50px" }
            },
            {
                animal: "ğŸ¢",
                objects: [
                    { type: "ground", class: "ground", position: { bottom: "0", left: "0" } }
                ],
                problem: "å°ä¹Œé¾Ÿç¿»ä¸è¿‡èº«ï¼Œéœ€è¦å¸®åŠ©",
                hint: "æç¤ºï¼šå°ä¹Œé¾Ÿçš„å£³å¾ˆç¡¬ï¼Œä½†è‚šå­æœä¸Š",
                correctAction: "push",
                explanation: "æ­£ç¡®ï¼è½»è½»ä¸€æ¨å°±èƒ½å¸®å°ä¹Œé¾Ÿç¿»è¿‡èº«æ¥ã€‚",
                animalInitialPosition: { left: "150px", bottom: "30px" },
                animalInitialRotation: "rotate(180deg)",
                animalFinalRotation: "rotate(0deg)"
            },
            {
                animal: "ğŸ¦’",
                objects: [
                    { type: "fence", emoji: "ğŸŒ¿", class: "fence", position: { top: "40px", left: "30px" } },
                    { type: "tree", emoji: "ğŸŒ³", class: "tree", position: { right: "20px", bottom: "20px" } }
                ],
                problem: "é•¿é¢ˆé¹¿çš„è„–å­å¡åœ¨æ ‘æé—´",
                hint: "æç¤ºï¼šé•¿é¢ˆé¹¿çš„è„–å­å¾ˆé•¿ï¼Œä½†æ ‘æå¾ˆå¯†",
                correctAction: "pull",
                explanation: "æ­£ç¡®ï¼éœ€è¦å°å¿ƒåœ°æŠŠé•¿é¢ˆé¹¿ä»æ ‘æé—´æ‹‰å‡ºæ¥ã€‚",
                animalInitialPosition: { left: "35px", top: "45px" },
                animalFinalPosition: { left: "35px", top: "-30px" }
            }
        ];

        // æ¸¸æˆçŠ¶æ€
        let currentLevel = 0;
        let score = 0;
        const totalLevels = gameData.length;

        // DOMå…ƒç´ 
        const levelElement = document.getElementById('level');
        const progressBar = document.getElementById('progress-bar');
        const problemElement = document.getElementById('problem');
        const hintElement = document.getElementById('hint');
        const sceneElement = document.getElementById('scene');
        const pushButton = document.getElementById('push-btn');
        const pullButton = document.getElementById('pull-btn');
        const feedbackElement = document.getElementById('feedback');
        const medals = [
            document.getElementById('medal-1'),
            document.getElementById('medal-2'),
            document.getElementById('medal-3')
        ];

        // å­˜å‚¨å½“å‰åœºæ™¯çš„å¯¹è±¡å¼•ç”¨
        let currentAnimalElement = null;
        let currentObjectElements = [];

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            updateScene();
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶ç›‘å¬
            pushButton.addEventListener('click', () => checkAnswer('push'));
            pullButton.addEventListener('click', () => checkAnswer('pull'));
            
            // ç”ŸæˆäºŒç»´ç 
            generateQRCode();
        }

        // æ›´æ–°åœºæ™¯
        function updateScene() {
            const currentData = gameData[currentLevel];
            levelElement.textContent = currentLevel + 1;
            
            // æ›´æ–°æ–‡æœ¬åŒºåŸŸ
            problemElement.textContent = currentData.problem;
            hintElement.textContent = currentData.hint;
            
            // æ¸…ç©ºåœºæ™¯
            sceneElement.innerHTML = '';
            currentObjectElements = [];
            
            // æ·»åŠ å…¶ä»–ç‰©ä½“ï¼ˆå…ˆæ·»åŠ ç‰©ä½“ï¼Œå†æ·»åŠ åŠ¨ç‰©ï¼Œç¡®ä¿åŠ¨ç‰©åœ¨ç‰©ä½“ä¸Šæ–¹ï¼‰
            currentData.objects.forEach((obj, index) => {
                const objElement = document.createElement('div');
                
                if (obj.type === 'hole' || obj.type === 'ground') {
                    // å¯¹äºéemojiå…ƒç´ ï¼Œä½¿ç”¨divå’ŒCSSæ ·å¼
                    objElement.className = `${obj.class}`;
                } else {
                    objElement.className = `${obj.class} scene-object`;
                    objElement.textContent = obj.emoji;
                }
                
                // è®¾ç½®ä½ç½®
                Object.keys(obj.position).forEach(pos => {
                    objElement.style[pos] = obj.position[pos];
                });
                
                sceneElement.appendChild(objElement);
                currentObjectElements.push(objElement);
            });
            
            // æ·»åŠ åŠ¨ç‰©
            currentAnimalElement = document.createElement('div');
            currentAnimalElement.className = 'animal scene-object';
            currentAnimalElement.textContent = currentData.animal;
            currentAnimalElement.id = 'animal';
            
            // è®¾ç½®åŠ¨ç‰©åˆå§‹ä½ç½®
            Object.keys(currentData.animalInitialPosition).forEach(pos => {
                currentAnimalElement.style[pos] = currentData.animalInitialPosition[pos];
            });
            
            // è®¾ç½®åŠ¨ç‰©åˆå§‹æ—‹è½¬ï¼ˆå¦‚æœæœ‰ï¼‰
            if (currentData.animalInitialRotation) {
                currentAnimalElement.style.transform = currentData.animalInitialRotation;
            }
            
            sceneElement.appendChild(currentAnimalElement);
            
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            
            // å¯ç”¨æŒ‰é’®
            pushButton.disabled = false;
            pullButton.disabled = false;
            
            // æ›´æ–°è¿›åº¦æ¡
            progressBar.style.width = `${(currentLevel / totalLevels) * 100}%`;
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer(action) {
            const currentData = gameData[currentLevel];
            
            // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
            pushButton.disabled = true;
            pullButton.disabled = true;
            
            // ç§»é™¤ä¹‹å‰çš„åŠ¨ç”»
            if (currentAnimalElement) {
                currentAnimalElement.classList.remove('shake');
            }
            
            currentObjectElements.forEach(obj => {
                obj.classList.remove('shake');
            });
            
            if (action === currentData.correctAction) {
                // æ­£ç¡®ç­”æ¡ˆ
                score++;
                feedbackElement.textContent = currentData.explanation;
                feedbackElement.className = 'feedback correct';
                
                // æ’­æ”¾æ­£ç¡®åŠ¨ç”»
                if (currentData.animalFinalPosition && currentAnimalElement) {
                    Object.keys(currentData.animalFinalPosition).forEach(pos => {
                        currentAnimalElement.style[pos] = currentData.animalFinalPosition[pos];
                    });
                }
                
                if (currentData.animalFinalRotation && currentAnimalElement) {
                    currentAnimalElement.style.transform = currentData.animalFinalRotation;
                }
                
                if (currentData.objectFinalPosition && currentObjectElements[0]) {
                    Object.keys(currentData.objectFinalPosition).forEach(pos => {
                        currentObjectElements[0].style[pos] = currentData.objectFinalPosition[pos];
                    });
                }
                
                // æ›´æ–°å‹‹ç« 
                updateMedals();
                
                // å»¶è¿Ÿè¿›å…¥ä¸‹ä¸€å…³
                setTimeout(nextLevel, 2000);
            } else {
                // é”™è¯¯ç­”æ¡ˆ
                feedbackElement.textContent = "ä¸å¯¹å“¦ï¼Œå†æƒ³æƒ³ï¼çœ‹çœ‹æç¤ºã€‚";
                feedbackElement.className = 'feedback incorrect';
                
                // æ’­æ”¾é”™è¯¯åŠ¨ç”»
                if (currentAnimalElement) {
                    currentAnimalElement.classList.add('shake');
                }
                
                // é‡æ–°å¯ç”¨æŒ‰é’®
                setTimeout(() => {
                    pushButton.disabled = false;
                    pullButton.disabled = false;
                }, 1000);
            }
        }

        // æ›´æ–°å‹‹ç« æ˜¾ç¤º
        function updateMedals() {
            if (score >= 2) {
                medals[0].classList.add('earned');
                medals[0].classList.add('success-animation');
            }
            if (score >= 4) {
                medals[1].classList.add('earned');
                medals[1].classList.add('success-animation');
            }
            if (score >= 5) {
                medals[2].classList.add('earned');
                medals[2].classList.add('success-animation');
            }
        }

        // è¿›å…¥ä¸‹ä¸€å…³
        function nextLevel() {
            currentLevel++;
            
            if (currentLevel < totalLevels) {
                updateScene();
            } else {
                // æ¸¸æˆç»“æŸ
                endGame();
            }
        }

        // æ¸¸æˆç»“æŸ
        function endGame() {
            problemElement.textContent = "æ­å–œä½ ï¼å®Œæˆäº†æ‰€æœ‰æŒ‘æˆ˜ï¼";
            hintElement.textContent = "ä½ å·²ç»æˆä¸ºäº†ä¸€åçœŸæ­£çš„æ¨æ‹‰å°å‹‡å£«ï¼";
            
            sceneElement.innerHTML = '';
            const celebrationElement = document.createElement('div');
            celebrationElement.style.fontSize = '4rem';
            celebrationElement.textContent = 'ğŸ‰';
            celebrationElement.style.animation = 'success 2s infinite';
            sceneElement.appendChild(celebrationElement);
            
            feedbackElement.textContent = `ä½ çš„å¾—åˆ†: ${score}/${totalLevels}`;
            feedbackElement.className = 'feedback correct';
            
            pushButton.style.display = 'none';
            pullButton.style.display = 'none';
            
            // æ›´æ–°è¿›åº¦æ¡
            progressBar.style.width = '100%';
            
            // ç¡®ä¿æ‰€æœ‰å‹‹ç« éƒ½æ˜¾ç¤º
            updateMedals();
        }

        // ç”ŸæˆäºŒç»´ç 
        function generateQRCode() {
            // è·å–å½“å‰é¡µé¢çš„URL
            const currentUrl = window.location.href;
            
            // ä½¿ç”¨QRCode.jsç”ŸæˆäºŒç»´ç 
            QRCode.toCanvas(document.getElementById('qrcode'), currentUrl, {
                width: 180,
                margin: 1,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function (error) {
                if (error) console.error(error);
                console.log('äºŒç»´ç ç”ŸæˆæˆåŠŸï¼');
            });
        }

        // å¯åŠ¨æ¸¸æˆ
        initGame();
    </script>
</body>
</html>